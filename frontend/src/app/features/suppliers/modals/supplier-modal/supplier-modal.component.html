<div class="fixed inset-0 bg-black/50 flex items-center justify-center z-50">
  <div class="bg-white rounded-lg w-full max-w-lg p-6">
    <h2 class="text-xl font-semibold mb-4">
        @if (supplier()) {
            Edit Supplier
        } @else {
            Create Supplier
        }
    </h2>

    <div class="space-y-3">
        <div>
            <label class="text-sm font-medium">
            Name <span class="text-red-500">*</span>
            </label>
            <input
                class="w-full border p-2 rounded"
                placeholder="Name"
                [class.border-red-500]="isNameInvalid()"
                [value]="name()"
                (input)="name.set($any($event.target).value)"
                (blur)="touchedName.set(true)" />

            @if (isNameInvalid()) {
                <p class="text-xs text-red-500 mt-1">required field</p>
            }
        </div>

        <div class="grid grid-cols-2 gap-3">
            <div>
                <label class="text-sm font-medium">
                    Person Type <span class="text-red-500">*</span>
                </label>
                <select
                    class="w-full border p-2 rounded"
                    [value]="type()"
                    (change)="onTypeChange($event)"
                    [disabled]="!!supplier()"
                    [class.bg-gray-100]="!!supplier()"
                    [class.cursor-not-allowed]="!!supplier()">
                    <option value="PF">PF</option>
                    <option value="PJ">PJ</option>
                </select>
            </div>

            <div>
                <label class="text-sm font-medium">
                {{cpfCnpjLabel()}} <span class="text-red-500">*</span>
                </label>
    
                <input
                    class="w-full border p-2 rounded"
                    maxlength="18"
                    placeholder="{{cpfCnpjLabel()}}"
                    [value]="maskedCpfCnpj()"
                    (input)="onCpfCnpjInput($event)"
                    (blur)="touchedCpfCnpj.set(true)"
                    [readonly]="cpfCnpjReadonly()"
                    [class.bg-gray-100]="cpfCnpjReadonly()"
                    [class.cursor-not-allowed]="cpfCnpjReadonly()"
                    [class.border-red-500]="touchedCpfCnpj() && !isCpfCnpjValid()"/>
    
                @if (isCpfCnpjEmpty()) {
                    <p class="text-xs text-red-500 mt-1">required field</p>
                }
                @else if (touchedCpfCnpj() && !isCpfCnpjValid()) {
                    <p class="text-xs text-red-600 mt-1">invalid {{cpfCnpjLabel()}}</p>
                }
            </div>
        </div>

        @if(isPf()) {
            <div class="grid grid-cols-2 gap-3">
                <div>
                    <label class="text-sm font-medium">
                        RG <span class="text-red-500">*</span>
                    </label>
                    <input
                        class="w-full border p-2 rounded"
                        placeholder="RG"
                        [value]="rg()"
                        (input)="onRgInput($event)"
                        (blur)="touchedRg.set(true)"
                        [class.border-red-500]="touchedRg() && !isRgValid()" />
    
                    @if (isRgEmpty()) {
                        <p class="text-xs text-red-500 mt-1">required field</p>
                    } @else if(touchedRg() && !isRgValid()) {
                        <p class="text-xs text-red-500 mt-1">invalid RG</p>
                    }
                </div>
    
                <div>
                    <label class="text-sm font-medium">
                        Birthday <span class="text-red-500">*</span>
                    </label>
                    <input
                        type="date"
                        class="w-full border p-2 rounded"
                        [max]="today()"
                        [value]="birthdate()"
                        (change)="birthdate.set($any($event.target).value)"
                        (blur)="touchedBirthdate.set(true)"
                        [class.border-red-500]="touchedBirthdate() && !isBirthdateValid()" />
    
                    @if (isBirthdateEmpty()) {
                        <p class="text-xs text-red-500 mt-1">required field</p>
                    } @else if(touchedBirthdate() && !isBirthdateValid()) {
                        <p class="text-xs text-red-500 mt-1">invalid date</p>
                    }
                </div>
            </div>
        }

        <div>
            <label class="text-sm font-medium">
                Email <span class="text-red-500">*</span>
            </label>
            <input
                class="w-full border p-2 rounded"
                placeholder="email@example.com"
                [value]="email()"
                (input)="onEmailInput($event)"
                (blur)="touchedEmail.set(true)"
                [class.border-red-500]="touchedEmail() && !isEmailValid()" />

            @if (isEmailEmpty()) {
                <p class="text-xs text-red-500 mt-1">required field</p>
            } @else if(touchedEmail() && !isEmailValid()) {
                <p class="text-xs text-red-500 mt-1">invalid email</p>
            }
        </div>

        <div class="grid grid-cols-2 gap-3">
            <div>
                <label class="text-sm font-medium">
                CEP <span class="text-red-500">*</span>
                </label>
    
                <input
                    class="w-full border p-2 rounded"
                    [class.border-red-500]="isCepInvalid()"
                    placeholder="CEP"
                    [value]="cep()"
                    (input)="onCepInput($event)"
                    (blur)="touchedCep.set(true)"/>
    
                @if (isCepInvalid()) {
                    <p class="text-xs text-red-500 mt-1">
                        {{ cepNotFound() ? 'invalid CEP' : 'required field' }}
                    </p>
                }
            </div>
    
            <div>
                <label class="text-sm font-medium">
                UF
                </label>
                <input
                    class="w-full border p-2 rounded bg-gray-100 cursor-not-allowed"
                    placeholder="UF"
                    [value]="uf()"
                    readonly/>
            </div>
        </div>

    </div>

    <div class="flex justify-end gap-3 mt-6">
      <button class="px-4 py-2 border rounded cursor-pointer hover:bg-gray-300"
              (click)="cancel()">
        Cancel
      </button>

      <button 
        class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed"
        [class.bg-green-600]="isFormValid()"
        [class.bg-green-300]="!isFormValid()"
        [disabled]="!isFormValid()"
        (click)="save()">
            Save
      </button>
    </div>
  </div>
</div>